<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tour Package Search</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
    }
    .card-title {
      font-weight: 600;
    }
    .card {
      transition: all 0.3s ease;
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
    }
    .card-img-top {
      height: 180px;
      object-fit: cover;
    }
    .suggestions {
  border: 1px solid #ccc;
  max-height: 150px;
  overflow-y: auto;
  background: white;
  position: absolute;
  z-index: 1000;
  width: 31.5%;
}
.suggestions div {
  padding: 8px;
  cursor: pointer;
}
.suggestions div:hover {
  background-color: #f0f0f0;
}
  </style>
</head>
<body>

  <!-- SEARCH BAR -->
  <div class="container my-5">
    <div class="card p-4 shadow-sm rounded-4">
      <form id="searchForm">
        <div class="row g-3">
          <div class="col-md-4">
            <input type="text" id="destination" class="form-control" placeholder="Enter Destination" oninput="strictSuggestion(this.value)" autocomplete="off">
              <div id="suggestionBox" class="suggestions"></div>
          </div>
          <div class="col-md-3">
            <input type="date" id="startDate" class="form-control" required>
          </div>
          <div class="col-md-3">
            <input type="date" id="endDate" class="form-control" required>
          </div>
          <div class="col-md-2">
            <button type="submit" class="btn btn-primary w-100">Search</button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- RESULTS -->
  <div class="container">
    <div id="results" class="row row-cols-1 row-cols-md-3 g-4 mt-4">
      <!-- Tour cards appear here -->
    </div>
  </div>

  <!-- SCRIPT -->
  <script>
      const destinations = [
  "Manali", "Goa", "Udaipur", "Shimla", "Kullu", "Leh", "Ladakh", 
  "Jaipur", "Rishikesh", "Darjeeling", "Munnar", "Ooty", 
  "Nainital", "Coorg", "Pondicherry", "Tawang"
];

function strictSuggestion(input) {
  const box = document.getElementById("suggestionBox");
  box.innerHTML = "";
  if (!input.trim()) return;

  const inputLower = input.toLowerCase();

  // Rank and strictly filter
  const results = destinations
    .map(place => {
      const placeLower = place.toLowerCase();
      let score = 0;

      if (placeLower === inputLower) score = 100;
      else if (placeLower.startsWith(inputLower)) score = 90;
      else if (placeLower.includes(inputLower)) score = 70;
      else score = similarityScore(placeLower, inputLower); // fuzzy

      return { place, score };
    })
    .filter(item => item.score > 50) // Show only highly relevant
    .sort((a, b) => b.score - a.score)
    .slice(0, 5); // Limit to top 5

  results.forEach(({ place }) => {
    const div = document.createElement("div");
    div.textContent = place;
    div.onclick = () => {
      document.getElementById("destination").value = place;
      box.innerHTML = "";
      filterPackages?.(); // Optional callback
    };
    box.appendChild(div);
  });
}

// A basic similarity score function (Levenshtein-like light)
function similarityScore(word, input) {
  let match = 0;
  for (let i = 0; i < Math.min(word.length, input.length); i++) {
    if (word[i] === input[i]) match++;
  }
  return (match / word.length) * 100;
}
    document.getElementById("searchForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const destination = document.getElementById("destination").value;
      const start = new Date(document.getElementById("startDate").value);
      const end = new Date(document.getElementById("endDate").value);
      const duration = Math.ceil((end - start) / (1000 * 60 * 60 * 24));

      const packages = [
        {
          title: `${destination} Premium Getaway`,
          price: 14999 + (duration * 1000),
          discount: "10%",
          duration: `${duration} Days`,
          image: "https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.naturetravelagency.com%2Fblogdetails.php%3Furi%3Dbest-time-to-visit-in-nainital&psig=AOvVaw2kdYaNWy-EVb3GvOn163Tw&ust=1751264808978000&source=images&cd=vfe&opi=89978449&ved=0CBQQjRxqFwoTCLjp-_j_lY4DFQAAAAAdAAAAABAL",
          link: "results.html"
        },
        {
          title: `${destination} Budget Escape`,
          price: 8999 + (duration * 500),
          discount: "5%",
          duration: `${duration} Days`,
          image: "https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.stayvista.com%2Fblog%2Fbest-time-to-visit-nainital%2F&psig=AOvVaw2kdYaNWy-EVb3GvOn163Tw&ust=1751264808978000&source=images&cd=vfe&opi=89978449&ved=0CBQQjRxqFwoTCLjp-_j_lY4DFQAAAAAdAAAAABAE",
          link: "results.html"
        },
        {
          title: `${destination} Family Retreat`,
          price: 11999 + (duration * 800),
          discount: "15%",
          duration: `${duration} Days`,
          image: "https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.thrillophilia.com%2Fcities%2Fnainital%2Ftags%2Ffamily-tours&psig=AOvVaw17yqYVtz_JZ37dIT6eqf6S&ust=1751264866272000&source=images&cd=vfe&opi=89978449&ved=0CBQQjRxqFwoTCODev5WAlo4DFQAAAAAdAAAAABAE",
          link: "results.html"
        }
      ];
      

      const resultsContainer = document.getElementById("results");
      resultsContainer.innerHTML = "";

      packages.forEach(pkg => {
        resultsContainer.innerHTML += `
          <div class="col">
            <div class="card h-100 shadow-sm rounded-4">
              <img src="${pkg.image}" class="card-img-top" alt="${pkg.title}">
              <div class="card-body">
                <h5 class="card-title">${pkg.title}</h5>
                <p class="card-text">Duration: ${pkg.duration}</p>
                <p class="card-text">Price: â‚¹${pkg.price.toLocaleString()}</p>
                <p class="card-text text-success">Discount: ${pkg.discount}</p>
                <a href="${pkg.link}" class="btn btn-sm btn-outline-primary">View Details</a>
              </div>
            </div>
          </div>
        `;
      });
    });
  </script>

</body>
</html>
